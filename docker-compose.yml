version: '3.8'

services:
  admin-backend:
    build:
      context: ./backend
    environment:
      # 连接到共享网络中的 mysql 容器 (pet_mysql)
      DATABASE_URL: mysql+pymysql://root:root@pet_mysql/pet_marketplace
      ADMIN_DATABASE_URL: mysql+pymysql://root:root@pet_mysql/pet_marketplace_admin
    ports:
      - "8001:8001"
    volumes:
      - ./backend:/app
    networks:
      - pet-network

  admin-frontend:
    build:
      context: .
    ports:
      - "3001:3001"
    depends_on:
      - admin-backend
    volumes:
      - .:/app
      - /app/node_modules
    networks:
      - pet-network

# 使用 Pet Marketplace 创建的共享网络
networks:
  pet-network:
    external: true
    name: pet_shared_network
